---
title: "Question Set Solution"
subtitle: "Agricultural Statistics, 4th Semester, IAAS, 2078"
author: |
  | Deependra Dhakal
  <!-- | Non Affiliated -->
date: "November, 2021"
output: 
  bookdown::pdf_document2:
    keep_tex: yes
    toc: false
    includes:
      in_header: is4ss2078_header.tex
documentclass: exam
classoption: "answers,addpoints,12pt"
geometry: "top=1.5cm,bottom=1.5cm,left=1.5cm,right=1.5cm"

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, include = TRUE, message = FALSE, warning = FALSE)
options(knitr.kable.NA = '', kableExtra.latex.load_packages = TRUE)
require(tidyverse)
```

# Essay Type Question

\bquestions

\question[10] \label{quest:first}

A set of data involving four feed stuffs used A, B, C and D tried on certain 20 mice is given in Table \ref{tab:mice-weight-gain} below. All the mice are treated alike in all respects except the following treatment and each feeding is given to 5 mice.

```{r mice-weight-gain}
mice_weight_gain <- tribble(
  ~"Feed", ~"Weight gain1", ~"Weight gain2", ~"Weight gain3", ~"Weight gain4", ~"Weight gain5",
  "A", 45, 56, 54, NA, NA,
  "B", 45, 65, 67, 23, NA,
  "C", 23, 45, 18, 67, 78,
  "D", 45, 34, NA, NA, NA
) 

mice_weight_gain %>%
  knitr::kable(booktabs = TRUE, col.names = c("Feed", rep(" ", times = 5)), caption = "Feeding treatment and weight gain in mice", align = "l", longtable = TRUE) %>% # longtable = TRUE is absolutely essential
  kableExtra::kable_styling() %>%
  kableExtra::add_header_above(header = c(" " = 1, "Weight gain" = 5))
```

Test the hypothesis that the mean effect of feeds is same or not.

\bsolution (Question \ref{quest:first}) 

Given information in the Table \ref{tab:mice-weight-gain} from feeding experiment involves missing data for some mice (Only x mice are represented despite involving a total of 20).

Since we are interested in whether or not the weight gain due to different feed ($t = 4$) are different, a widely used technique for comparison of group difference involving more that 2 groups is F-test. The F-test can be employed most easily with analysis of variance (ANOVA) setting. Although, it should be noted, due to unequal group sizes (ie. there are 3 mice in Feed A group, 4 mice in Feed B group, and so on), validity of group difference comparison is limited only to the data available.

```{r mice-weight-gain-reshaped}
mice_weight_gain_long <- mice_weight_gain %>% 
  pivot_longer(cols = 2:6, names_to = "individual", values_to = "weight_gain") %>% 
  select(-individual)

group_means_mice_weight <- mice_weight_gain_long %>% 
  group_by(Feed) %>% 
  summarise(mean_weight_gain = mean(weight_gain, na.rm = TRUE))

group_means_mice_weight %>%
  mutate_if(is.numeric, .funs = list(~round(., digits = 2))) %>% 
  rename("Mean weight gain" = "mean_weight_gain") %>%
  knitr::kable(booktabs = TRUE, caption = "Mean weight gain of mice in each treatment (feeding) group", align = "l", longtable = TRUE) %>%
  kableExtra::kable_styling(position = "center", repeat_header_continued = T)

```


To detect the difference in treatment means, we formulate the following Null hypothesis, of which if no sufficient evidence is found for acceptance we assert that difference between mean of Feeding groups exist.

$$\mu_{A} = \mu_{B} = \mu_C = \mu_D = \mu_E$$

Total variance due to feeding treatment can be disaggregated into effects due to Feed and the noise (residual). Respective variances components, degrees of freedom, and the F-value for treatment factor are computed and shown in the ANOVA (Table \ref{tab:mice-weight-gain-anova}).

```{r mice-weight-gain-anova}
anova_mice_weight <- anova(lm(data = mice_weight_gain_long, weight_gain ~ Feed)) %>% 
  broom::tidy() %>% 
  janitor::clean_names()

anova_mice_weight %>%
  mutate_if(is.numeric, .funs = list(~round(., digits = 2))) %>% 
  rename("Source of variation" = "term", 
         "DF" = "df",
         "Sum of squares" = "sumsq",
         "Mean sum of squares" = "meansq",
         "F-value" = "statistic",
         "P-value" = "p_value") %>% 
  knitr::kable(booktabs = TRUE, caption = "ANOVA of study on mice weight gain due to various feeding treatment", align = "l", longtable = TRUE) %>%
  kableExtra::kable_styling(position = "center", repeat_header_continued = T, font_size = 10) %>% 
  kableExtra::column_spec(column = 1:6, width = c("5em", "2em", "8em", "8em", "6em", "4em", "3em"))
 
(agricolae::LSD.test(lm(data = mice_weight_gain_long, weight_gain ~ Feed), "Feed"))$groups %>%
  as_tibble(rownames = "Feed") %>%
  mutate_if(is.numeric, .funs = list(~round(., digits = 2))) %>% 
  rename("Weight gain" = "weight_gain",
         "Groups" = "groups") %>%
  knitr::kable(booktabs = TRUE, caption = "Difference of mean between treatment groups using LSD method. Group difference is indicated by lowercase letters in the Group column.", align = "l", longtable = TRUE) %>%
  kableExtra::kable_styling(position = "center")
```

F-test showed that variance due to Feeding treatment is basically a noise (i.e. difference among observations in weight gain cannot be attributed to Feed factor). We can further the confirm the idea by pairwise comparison of means using LSD test, which suggests that all feeding groups are same. Hence, it can be concluded, based on Null Hypothesis Significance Testing (NHST), that mean effect of feed is not different.

\esolution

\equestions

# Short Questions

\bquestions

\question[4] \label{quest:second}

Wheat do you mean by the random sampling ? Differentiate between stratified sampling and cluster sampling.

\bsolution

Sampling is the selection of a subset (a statistical sample) of individuals from within a statistical population to estimate characteristics of the whole population.

Most basic form of sampling is the simple random sampling, in which every sample of size n has the same chance of being selected. In addition to simple random sampling, there are other sampling plans that involve randomization and therefore provide a probabilistic basis for inference making.

When the population consists of two or more subpopulations, called strata, a sampling plan that ensures that each subpopulation is represented in the sample is called a stratified random sample.

Another form of random sampling is used when the available units are groups of elements, called clusters. For example, a household is a cluster of individuals living together. A ward, in similar way, might be a convenient sampling unit and might be considered a cluster for a given sampling plan. A cluster sample is hence, a simple random sample of clusters from the available clusters in the population.

\esolution

\equestions

